# 密码快速填充浮窗功能设计 (v1.1.5)

## 功能概述

当用户在任意网站中注册账号或填写密码时，插件能够识别表单中的密码输入框，并在用户选中密码框时展示一个浮窗，提供密码生成和快速填充功能。该功能将使用用户在插件popup中已配置的密码生成策略，保持一致的用户体验。

## 第一阶段功能设计

### 1. 密码框识别机制

- **识别方式**：通过DOM元素的`type="password"`属性识别密码输入框
- **触发时机**：
  - 用户点击/选中密码框时
  - 用户Tab键切换到密码框时
- **特殊情况处理**：
  - 处理多个密码框（如"密码"和"确认密码"）的情况

### 2. 浮窗设计

- **位置**：紧贴密码框下方（根据页面空间自动调整）
- **样式**：
  - 轻量简洁，白色背景
  - 圆角设计，与Easy Password主题风格一致
  - 适当阴影效果，与页面区分
- **内容组成**：
  - 浮窗标题（[logo] [Easy Password]）
  - 生成的密码显示框（默认显示一个随机生成的密码）
  - 密码强度指示器（与popup界面一致的设计）
  - 刷新按钮（生成新密码）
  - 填充按钮（将密码填入表单）

### 3. 交互流程

1. 用户选中网页中的密码输入框
2. 插件识别到密码框，在其下方弹出浮窗
3. 浮窗中默认显示一个根据用户设置生成的密码
4. 用户可以：
   - 直接点击"填充"按钮将密码填入表单
   - 点击"刷新"按钮生成新的随机密码
   - 点击页面其他区域关闭浮窗

### 4. 密码生成策略

- 使用用户在popup.html中已配置的密码生成策略：
  - 密码类型（随机密码/易记密码）
    - 随机密码
      - 密码长度/单词数量
      - 字符类型（包含数字/符号）
    - 易记密码
      - 分隔符选择
      - 首字母大写设置
- 复用现有的passwordService服务：
  - 使用相同的密码生成逻辑
  - 使用相同的密码强度评估逻辑

### 5. 密码强度评估

- 在浮窗中显示密码强度指示器：
  - 强度指示条（4段式设计，与popup界面一致）
  - 密码熵值显示
  - 密码强度等级文本显示
- 当刷新生成新密码时，强度指示器自动更新
- 使用passwordService.evaluateStrength()方法评估密码强度

### 6. 技术实现要点

- 使用内容脚本(content script)识别密码框并注入浮窗
- 使用Chrome Storage API读取用户的密码生成偏好设置
- 共享popup.js中的密码生成逻辑，确保浮窗生成的密码与popup中生成的密码遵循相同规则
- 使用MutationObserver监听DOM变化，及时识别新出现的密码框
- 浮窗采用绝对定位，根据密码框位置动态调整

### 7. 用户体验考虑

- 浮窗在用户点击页面其他区域时自动关闭
- 填充密码后自动关闭浮窗
- 浮窗样式与网页内容明显区分，避免混淆
- 浮窗中的按钮提供悬停效果，增强交互反馈
- 密码强度指示器提供直观的视觉反馈

## 后续迭代计划

### 第二阶段
- 改进密码框识别准确率
- 优化浮窗UI/UX
- 自适应浮窗位置（避免超出视口）
- 添加浮窗显示/隐藏的全局开关

### 第三阶段
- 智能识别网站密码规则
- 用户自定义设置（是否启用浮窗、浮窗位置等）
- 多语言支持
- 处理iframe嵌套页面的情况